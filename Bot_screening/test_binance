from binance import Client
import time
import json
import hmac
import hashlib
import requests
from urllib.parse import urljoin, urlencode
import api_keys
import api_keys_arcadia
import pandas as pd

list_symbols = []
client = Client(api_keys.API_KEY, api_keys.SECRET)
exchange_info = client.get_exchange_info()
for s in exchange_info['symbols']:
    if(s["quoteAsset"] == 'BTC'):
        list_symbols.append(s['symbol'])
print(list_symbols)

klines = client.get_historical_klines("BNBBTC", Client.KLINE_INTERVAL_1DAY, "1 Jan, 2022")  #"1 Dec, 2017", "1 Jan, 2018" per un intervallo
df_klines = pd.DataFrame(klines)
df_klines.columns = ['Open time', 'Open price', 'High price', 'Low price', 'Close price', 'Volume', 'Close time', 'trash1', 'trash2', 'trash3', 'trash4', 'trash5']
df_klines['Open time'] = pd.to_datetime(int(df_klines['Open time'])/1000, unit = 's').dt.date
df_klines['Close price'] = pd.to_datetime(int(df_klines['Close price'])/1000, unit = 's').dt.date
print(df_klines)